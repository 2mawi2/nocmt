# nocmt - Clean Up AI-Generated Comments

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Go Report Card](https://goreportcard.com/badge/github.com/2mawi2/nocmt)](https://goreportcard.com/report/github.com/2mawi2/nocmt)
[![Test Coverage](https://img.shields.io/badge/coverage-65%25-yellowgreen)](https://github.com/2mawi2/nocmt/actions)

> **Clean code speaks for itself. Let it.**

A fast, language-aware tool that strips unwanted comments from your code. Perfect for removing those verbose explanations generated by AI coding assistants like GitHub Copilot, Cursor, and WindSurf.

*Because let's face it - if your code needs a novel-length explanation, maybe it's the code that needs fixing, not the documentation.*

## Why nocmt?

- **AI Comment Cleanup**: Remove those verbose explanations AI tools love to add to your code
- **Code Cleanup**: Commit clean, professional code without unnecessary comments
- **Keep Only What Matters**: Preserve important directives like `//go:generate`
- **Selective Processing**: Remove comments only from changed lines in git-staged files
- **Customizable**: Powerful regex patterns to keep specific comments

## Installation

### Homebrew

You can install nocmt using Homebrew:

```bash
brew tap 2mawi2/tap
brew install nocmt
```

```bash
# Using go install
go install github.com/2mawi2/nocmt@latest

# From source
git clone https://github.com/2mawi2/nocmt.git
cd nocmt
go build
```

## Quick Start

Ready to let your code speak for itself? Here's how:

```bash
# Remove AI-generated comments from staged changes (default)
nocmt

# Remove comments from a specific file
nocmt main.go

# Process an entire project directory
nocmt ./src

# Keep your TODO comments while removing AI explanations
nocmt --add-ignore "TODO"

# Install as a pre-commit hook (automatically clean all future commits)
nocmt install
```

## AI Comment Removal

nocmt was specifically designed to help developers who use AI coding assistants maintain clean, professional codebases:

- Remove those paragraph-long explanations that AI tools love to add
- Strip away "here's what I'm doing" commentary from your code
- Keep your code review process focused on your logic, not AI verbosity
- Perfect for everybody that uses GitHub Copilot, Cursor, WindSurf, Claude Code, or other agentic AI coding tools
- Prepare your code for professional review or open source contribution

## The Great Comment Debate

*"Code is like a joke. If you have to explain it, it's bad."* â€” Anonymous AI

### Why Comments Can Be Problematic

- **Self-documenting code** should be the ideal - clear names, logical structure, and obvious intent
- **Comments get outdated** faster than the code they describe, creating dangerous misinformation
- **Cognitive load** increases when developers must parse both code and comments
- **Code reviews** get cluttered with commentary instead of focusing on logic and edge cases

### The AI Comment Controversy

AI coding assistants have reignited this debate by generating copious amounts of comments:

- **Context window waste:** Research shows verbose comments consume valuable tokens that could be used for more code [1]
- **Performance impact:** For simple, self-documenting code, removing comments can improve model performance by up to 40% [2]
- **Mixed results:** For complex algorithms, strategic comments actually improve an AI's reasoning and code quality [3]
- **Style mismatch:** AI tools often produce comments in a different style than the existing codebase

nocmt gives you control back by letting you decide exactly which comments stay and which go. Because in the end, it's _your_ code that matters.

## Supported Languages

- Go
- JavaScript/TypeScript
- Java
- Python
- Rust
- Bash
- CSS

## Usage

```
nocmt [path] [options]
```

By default, without any arguments, `nocmt` will process staged files in the current git repository.

### Common Usage Patterns

```bash
# Process staged changes in current directory (most common use case)
nocmt

# Process a specific file
nocmt main.go

# Preview changes without applying them
nocmt --dry-run

# Process an entire directory
nocmt ./src

# Install git pre-commit hook (automatically clean all future commits)
nocmt install
```

### Options

- `path`: Optional. Path to file or directory to process (if omitted, processes git staged files)
- `--dry-run`, `-d`: Preview changes without modifying files
- `--all`, `-a`: Process all files recursively (be careful with large codebases)
- `--ignore "pattern1,pattern2"`: Preserve comments matching these regex patterns
- `--add-ignore "pattern"`: Add a regex pattern to the project's ignore list (.nocmt.json)
- `--add-ignore-global "pattern"`: Add a regex pattern to your global ignore list
- `--verbose`, `-v`: Show detailed output during processing
- `--force`, `-f`: Run in non-git directories (default requires git repository)
- `--remove-directives`, `-r`: Remove compiler directives (preserved by default)

### Commands

- `install`: Install nocmt as a git pre-commit hook

## Configuration

nocmt supports both global (`~/.nocmt/config.json`) and project-specific (`.nocmt.json`) configuration:

```json
{
  "ignorePatterns": [
    "TODO",                  // Keep TODO comments
    "^\\s*//\\s*WHY",        // Keep comments that explain why decisions were made
    "#\\d+",                 // Keep issue/PR references
    "TESTPROJECT-\\d+"       // Keep Jira ticket references
  ]
}
```

Use `--add-ignore "pattern"` to add patterns to your project configuration or `--add-ignore-global "pattern"` to add them globally.

## Git Integration

### Pre-commit Hook

Installing nocmt as a pre-commit hook ensures your commits are always free of unwanted comments:

```bash
# Install git pre-commit hook
nocmt install
```

### Using with pre-commit framework

```yaml
repos:
- repo: https://github.com/2mawi2/nocmt
  rev: v1.0.0  # Use the latest version
  hooks:
  - id: nocmt
    name: nocmt
    description: Remove comments from source code
    entry: nocmt
    language: golang
    files: \.(go|js|ts|java|py|cs|rs|kt|swift|sh|css)$
```

## License

[MIT License](LICENSE)

## References

[1] arXiv:2404.10155v1, "The impact of comment density on code generation performance", https://lsiddiqsunny.github.io/public/2404.10155v1.pdf

[2] arXiv:2505.07768, "Optimizing prompt efficiency in code generation tasks", https://arxiv.org/abs/2505.07768

[3] ACL 2024 Findings, Paper 809, "Logical comment prompting improves code generation", https://aclanthology.org/2024.findings-acl.809.pdf 